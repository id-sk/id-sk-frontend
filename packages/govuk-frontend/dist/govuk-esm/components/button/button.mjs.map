{"version":3,"file":"button.mjs","sources":["../../../../src/govuk/components/button/button.mjs"],"sourcesContent":["import { mergeConfigs } from '../../common/index.mjs'\nimport { normaliseDataset } from '../../common/normalise-dataset.mjs'\n\nvar KEY_SPACE = 32\nvar DEBOUNCE_TIMEOUT_IN_SECONDS = 1\n\n/**\n * JavaScript enhancements for the Button component\n *\n * @class\n * @param {Element} $module - HTML element to use for button\n * @param {ButtonConfig} [config] - Button config\n */\nfunction Button ($module, config) {\n  if (!($module instanceof HTMLElement)) {\n    return this\n  }\n\n  /** @deprecated Will be made private in v5.0 */\n  this.$module = $module\n\n  /** @deprecated Will be made private in v5.0 */\n  this.debounceFormSubmitTimer = null\n\n  /** @type {ButtonConfig} */\n  var defaultConfig = {\n    preventDoubleClick: false\n  }\n\n  /**\n   * @deprecated Will be made private in v5.0\n   * @type {ButtonConfig}\n   */\n  this.config = mergeConfigs(\n    defaultConfig,\n    config || {},\n    normaliseDataset($module.dataset)\n  )\n}\n\n/**\n * Initialise component\n */\nButton.prototype.init = function () {\n  // Check that required elements are present\n  if (!this.$module) {\n    return\n  }\n\n  this.$module.addEventListener('keydown', this.handleKeyDown)\n  this.$module.addEventListener('click', this.debounce.bind(this))\n}\n\n/**\n * Trigger a click event when the space key is pressed\n *\n * Some screen readers tell users they can activate things with the 'button'\n * role, so we need to match the functionality of native HTML buttons\n *\n * See https://github.com/alphagov/govuk_elements/pull/272#issuecomment-233028270\n *\n * @deprecated Will be made private in v5.0\n * @param {KeyboardEvent} event - Keydown event\n */\nButton.prototype.handleKeyDown = function (event) {\n  var $target = event.target\n\n  // Handle space bar only\n  if (event.keyCode !== KEY_SPACE) {\n    return\n  }\n\n  // Handle elements with [role=\"button\"] only\n  if ($target instanceof HTMLElement && $target.getAttribute('role') === 'button') {\n    event.preventDefault() // prevent the page from scrolling\n    $target.click()\n  }\n}\n\n/**\n * Debounce double-clicks\n *\n * If the click quickly succeeds a previous click then nothing will happen. This\n * stops people accidentally causing multiple form submissions by double\n * clicking buttons.\n *\n * @deprecated Will be made private in v5.0\n * @param {MouseEvent} event - Mouse click event\n * @returns {undefined | false} Returns undefined, or false when debounced\n */\nButton.prototype.debounce = function (event) {\n  // Check the button that was clicked has preventDoubleClick enabled\n  if (!this.config.preventDoubleClick) {\n    return\n  }\n\n  // If the timer is still running, prevent the click from submitting the form\n  if (this.debounceFormSubmitTimer) {\n    event.preventDefault()\n    return false\n  }\n\n  this.debounceFormSubmitTimer = setTimeout(/** @this {Button} */ function () {\n    this.debounceFormSubmitTimer = null\n  }.bind(this), DEBOUNCE_TIMEOUT_IN_SECONDS * 1000)\n}\n\nexport default Button\n\n/**\n * Button config\n *\n * @typedef {object} ButtonConfig\n * @property {boolean} [preventDoubleClick=false] - Prevent accidental double\n *   clicks on submit buttons from submitting forms multiple times.\n */\n"],"names":[],"mappings":";;;AAGA,IAAI,SAAS,GAAG,GAAE;AAClB,IAAI,2BAA2B,GAAG,EAAC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE;AAClC,EAAE,IAAI,EAAE,OAAO,YAAY,WAAW,CAAC,EAAE;AACzC,IAAI,OAAO,IAAI;AACf,GAAG;AACH;AACA;AACA,EAAE,IAAI,CAAC,OAAO,GAAG,QAAO;AACxB;AACA;AACA,EAAE,IAAI,CAAC,uBAAuB,GAAG,KAAI;AACrC;AACA;AACA,EAAE,IAAI,aAAa,GAAG;AACtB,IAAI,kBAAkB,EAAE,KAAK;AAC7B,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAE,IAAI,CAAC,MAAM,GAAG,YAAY;AAC5B,IAAI,aAAa;AACjB,IAAI,MAAM,IAAI,EAAE;AAChB,IAAI,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC;AACrC,IAAG;AACH,CAAC;AACD;AACA;AACA;AACA;AACA,MAAM,CAAC,SAAS,CAAC,IAAI,GAAG,YAAY;AACpC;AACA,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;AACrB,IAAI,MAAM;AACV,GAAG;AACH;AACA,EAAE,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,aAAa,EAAC;AAC9D,EAAE,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAC;AAClE,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,CAAC,SAAS,CAAC,aAAa,GAAG,UAAU,KAAK,EAAE;AAClD,EAAE,IAAI,OAAO,GAAG,KAAK,CAAC,OAAM;AAC5B;AACA;AACA,EAAE,IAAI,KAAK,CAAC,OAAO,KAAK,SAAS,EAAE;AACnC,IAAI,MAAM;AACV,GAAG;AACH;AACA;AACA,EAAE,IAAI,OAAO,YAAY,WAAW,IAAI,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,QAAQ,EAAE;AACnF,IAAI,KAAK,CAAC,cAAc,GAAE;AAC1B,IAAI,OAAO,CAAC,KAAK,GAAE;AACnB,GAAG;AACH,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,KAAK,EAAE;AAC7C;AACA,EAAE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,kBAAkB,EAAE;AACvC,IAAI,MAAM;AACV,GAAG;AACH;AACA;AACA,EAAE,IAAI,IAAI,CAAC,uBAAuB,EAAE;AACpC,IAAI,KAAK,CAAC,cAAc,GAAE;AAC1B,IAAI,OAAO,KAAK;AAChB,GAAG;AACH;AACA,EAAE,IAAI,CAAC,uBAAuB,GAAG,UAAU,uBAAuB,YAAY;AAC9E,IAAI,IAAI,CAAC,uBAAuB,GAAG,KAAI;AACvC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,2BAA2B,GAAG,IAAI,EAAC;AACnD,EAAC;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;"}