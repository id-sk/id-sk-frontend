{"version":3,"file":"checkboxes.mjs","sources":["../../../../src/govuk/components/checkboxes/checkboxes.mjs"],"sourcesContent":["import '../../vendor/polyfills/Element/prototype/classList.mjs'\n\n/**\n * Checkboxes component\n *\n * @class\n * @param {Element} $module - HTML element to use for checkboxes\n */\nfunction Checkboxes ($module) {\n  if (!($module instanceof HTMLElement)) {\n    return this\n  }\n\n  /** @satisfies {NodeListOf<HTMLInputElement>} */\n  var $inputs = $module.querySelectorAll('input[type=\"checkbox\"]')\n  if (!$inputs.length) {\n    return this\n  }\n\n  /** @deprecated Will be made private in v5.0 */\n  this.$module = $module\n\n  /** @deprecated Will be made private in v5.0 */\n  this.$inputs = $inputs\n}\n\n/**\n * Initialise component\n *\n * Checkboxes can be associated with a 'conditionally revealed' content block –\n * for example, a checkbox for 'Phone' could reveal an additional form field for\n * the user to enter their phone number.\n *\n * These associations are made using a `data-aria-controls` attribute, which is\n * promoted to an aria-controls attribute during initialisation.\n *\n * We also need to restore the state of any conditional reveals on the page (for\n * example if the user has navigated back), and set up event handlers to keep\n * the reveal in sync with the checkbox state.\n */\nCheckboxes.prototype.init = function () {\n  // Check that required elements are present\n  if (!this.$module || !this.$inputs) {\n    return\n  }\n\n  var $module = this.$module\n  var $inputs = this.$inputs\n\n  $inputs.forEach(function ($input) {\n    var targetId = $input.getAttribute('data-aria-controls')\n\n    // Skip checkboxes without data-aria-controls attributes, or where the\n    // target element does not exist.\n    if (!targetId || !document.getElementById(targetId)) {\n      return\n    }\n\n    // Promote the data-aria-controls attribute to a aria-controls attribute\n    // so that the relationship is exposed in the AOM\n    $input.setAttribute('aria-controls', targetId)\n    $input.removeAttribute('data-aria-controls')\n  })\n\n  // When the page is restored after navigating 'back' in some browsers the\n  // state of form controls is not restored until *after* the DOMContentLoaded\n  // event is fired, so we need to sync after the pageshow event in browsers\n  // that support it.\n  window.addEventListener(\n    'onpageshow' in window ? 'pageshow' : 'DOMContentLoaded',\n    this.syncAllConditionalReveals.bind(this)\n  )\n\n  // Although we've set up handlers to sync state on the pageshow or\n  // DOMContentLoaded event, init could be called after those events have fired,\n  // for example if they are added to the page dynamically, so sync now too.\n  this.syncAllConditionalReveals()\n\n  // Handle events\n  $module.addEventListener('click', this.handleClick.bind(this))\n}\n\n/**\n * Sync the conditional reveal states for all checkboxes in this $module.\n *\n * @deprecated Will be made private in v5.0\n */\nCheckboxes.prototype.syncAllConditionalReveals = function () {\n  this.$inputs.forEach(this.syncConditionalRevealWithInputState.bind(this))\n}\n\n/**\n * Sync conditional reveal with the input state\n *\n * Synchronise the visibility of the conditional reveal, and its accessible\n * state, with the input's checked state.\n *\n * @deprecated Will be made private in v5.0\n * @param {HTMLInputElement} $input - Checkbox input\n */\nCheckboxes.prototype.syncConditionalRevealWithInputState = function ($input) {\n  var targetId = $input.getAttribute('aria-controls')\n  if (!targetId) {\n    return\n  }\n\n  var $target = document.getElementById(targetId)\n  if ($target && $target.classList.contains('govuk-checkboxes__conditional')) {\n    var inputIsChecked = $input.checked\n\n    $input.setAttribute('aria-expanded', inputIsChecked.toString())\n    $target.classList.toggle('govuk-checkboxes__conditional--hidden', !inputIsChecked)\n  }\n}\n\n/**\n * Uncheck other checkboxes\n *\n * Find any other checkbox inputs with the same name value, and uncheck them.\n * This is useful for when a “None of these\" checkbox is checked.\n *\n * @deprecated Will be made private in v5.0\n * @param {HTMLInputElement} $input - Checkbox input\n */\nCheckboxes.prototype.unCheckAllInputsExcept = function ($input) {\n  var $component = this\n\n  /** @satisfies {NodeListOf<HTMLInputElement>} */\n  var allInputsWithSameName = document.querySelectorAll(\n    'input[type=\"checkbox\"][name=\"' + $input.name + '\"]'\n  )\n\n  allInputsWithSameName.forEach(function ($inputWithSameName) {\n    var hasSameFormOwner = ($input.form === $inputWithSameName.form)\n    if (hasSameFormOwner && $inputWithSameName !== $input) {\n      $inputWithSameName.checked = false\n      $component.syncConditionalRevealWithInputState($inputWithSameName)\n    }\n  })\n}\n\n/**\n * Uncheck exclusive checkboxes\n *\n * Find any checkbox inputs with the same name value and the 'exclusive' behaviour,\n * and uncheck them. This helps prevent someone checking both a regular checkbox and a\n * \"None of these\" checkbox in the same fieldset.\n *\n * @deprecated Will be made private in v5.0\n * @param {HTMLInputElement} $input - Checkbox input\n */\nCheckboxes.prototype.unCheckExclusiveInputs = function ($input) {\n  var $component = this\n\n  /** @satisfies {NodeListOf<HTMLInputElement>} */\n  var allInputsWithSameNameAndExclusiveBehaviour = document.querySelectorAll(\n    'input[data-behaviour=\"exclusive\"][type=\"checkbox\"][name=\"' + $input.name + '\"]'\n  )\n\n  allInputsWithSameNameAndExclusiveBehaviour.forEach(function ($exclusiveInput) {\n    var hasSameFormOwner = ($input.form === $exclusiveInput.form)\n    if (hasSameFormOwner) {\n      $exclusiveInput.checked = false\n      $component.syncConditionalRevealWithInputState($exclusiveInput)\n    }\n  })\n}\n\n/**\n * Click event handler\n *\n * Handle a click within the $module – if the click occurred on a checkbox, sync\n * the state of any associated conditional reveal with the checkbox state.\n *\n * @deprecated Will be made private in v5.0\n * @param {MouseEvent} event - Click event\n */\nCheckboxes.prototype.handleClick = function (event) {\n  var $clickedInput = event.target\n\n  // Ignore clicks on things that aren't checkbox inputs\n  if (!($clickedInput instanceof HTMLInputElement) || $clickedInput.type !== 'checkbox') {\n    return\n  }\n\n  // If the checkbox conditionally-reveals some content, sync the state\n  var hasAriaControls = $clickedInput.getAttribute('aria-controls')\n  if (hasAriaControls) {\n    this.syncConditionalRevealWithInputState($clickedInput)\n  }\n\n  // No further behaviour needed for unchecking\n  if (!$clickedInput.checked) {\n    return\n  }\n\n  // Handle 'exclusive' checkbox behaviour (ie \"None of these\")\n  var hasBehaviourExclusive = ($clickedInput.getAttribute('data-behaviour') === 'exclusive')\n  if (hasBehaviourExclusive) {\n    this.unCheckAllInputsExcept($clickedInput)\n  } else {\n    this.unCheckExclusiveInputs($clickedInput)\n  }\n}\n\nexport default Checkboxes\n"],"names":[],"mappings":"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"}