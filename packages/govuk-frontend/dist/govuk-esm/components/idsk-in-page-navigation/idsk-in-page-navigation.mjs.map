{"version":3,"file":"idsk-in-page-navigation.mjs","sources":["../../../../src/govuk/components/idsk-in-page-navigation/idsk-in-page-navigation.mjs"],"sourcesContent":["/* eslint-disable */\n\n/**\n * InPageNavigation Component\n */\nfunction IdskInPageNavigation ($module) {\n  this.$module = $module\n}\n\n/**\n * InPageNavigation init function\n */\nIdskInPageNavigation.prototype.init = function () {\n  // Check for module\n  var $module = this.$module\n  if (!$module) {\n    return\n  }\n\n  // Check for button\n  var $links = $module.querySelectorAll('.idsk-in-page-navigation__link')\n  if (!$links) {\n    return\n  }\n\n  // list of all ids and titles\n  this.$arrTitlesAndElems = []\n  // Handle $link click events\n  $links.forEach(\n    function ($link) {\n      var $item = {}\n      $item.el = document.getElementById($link.href.split('#')[1])\n      this.$arrTitlesAndElems.push($item)\n      $link.addEventListener('click', this.handleClickLink.bind(this))\n    }.bind(this)\n  )\n\n  var $linkPanelButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel'\n  )\n  if (!$linkPanelButton) {\n    return\n  }\n  $module.boundCheckCloseClick = this.checkCloseClick.bind(this)\n  $module.boundHandleClickLinkPanel = this.handleClickLinkPanel.bind(this)\n  $linkPanelButton.addEventListener(\n    'click',\n    $module.boundHandleClickLinkPanel,\n    true\n  )\n\n  // Handle floating navigation\n  window.addEventListener('scroll', this.scrollFunction.bind(this))\n  // Handle case if the viewport is shor and there are more than one article - scrolling is not needed, but navigation pointer has to be updated\n  this.$module.labelChanged = false\n}\n\n/**\n * An event handler for click event on $link - add actual title to link panel\n *\n * @param {object} e\n */\nIdskInPageNavigation.prototype.handleClickLink = function (e) {\n  var $link = e.target || e.srcElement\n  var $id = $link.closest('.idsk-in-page-navigation__link').href.split('#')[1]\n  var $panelHeight = this.$module.getElementsByClassName(\n    'idsk-in-page-navigation__link-panel'\n  )[0].offsetHeight\n\n  setTimeout(\n    function () {\n      if (document.getElementById($id) != null) {\n        this.$module.labelChanged = true\n        this.changeCurrentLink($link)\n        window.scrollTo(\n          0,\n          document.getElementById($id).offsetTop - $panelHeight * 2.5\n        )\n      } else {\n        this.changeCurrentLink($link)\n      }\n    }.bind(this),\n    10\n  )\n}\n\n/**\n * An event handler for click event on $linkPanel - collapse or expand in page navigation menu\n *\n * @param {object} e\n */\nIdskInPageNavigation.prototype.handleClickLinkPanel = function (e) {\n  var $module = this.$module\n  var $linkPanelButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel'\n  )\n  var $expandedButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel-button'\n  )\n\n  $module.classList.add('idsk-in-page-navigation--expand')\n  $linkPanelButton.removeEventListener(\n    'click',\n    $module.boundHandleClickLinkPanel,\n    true\n  )\n  $expandedButton.setAttribute('aria-expanded', 'true')\n  $expandedButton.setAttribute(\n    'aria-label',\n    $expandedButton.getAttribute('data-text-for-show')\n  )\n  document.addEventListener('click', $module.boundCheckCloseClick, true)\n}\n\n/**\n * close navigation if the user click outside navigation\n *\n * @param {object} e\n */\nIdskInPageNavigation.prototype.checkCloseClick = function (e) {\n  var $el = e.target || e.srcElement\n  var $navigationList = $el.closest('.idsk-in-page-navigation__list')\n  var $module = this.$module\n  var $linkPanelButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel'\n  )\n  var $expandedButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel-button'\n  )\n\n  if ($navigationList == null) {\n    e.stopPropagation() // prevent bubbling\n    $module.classList.remove('idsk-in-page-navigation--expand')\n    $linkPanelButton.addEventListener(\n      'click',\n      $module.boundHandleClickLinkPanel,\n      true\n    )\n    document.removeEventListener('click', $module.boundCheckCloseClick, true)\n    $expandedButton.setAttribute('aria-expanded', 'false')\n    $expandedButton.setAttribute(\n      'aria-label',\n      $expandedButton.getAttribute('data-text-for-hide')\n    )\n  }\n}\n\n/**\n * When the user scrolls down from the top of the document, set position to fixed\n */\nIdskInPageNavigation.prototype.scrollFunction = function () {\n  var $module = this.$module\n  var $arrTitlesAndElems = this.$arrTitlesAndElems\n  var $parentModule = $module.parentElement\n  var $navTopPosition = $parentModule.offsetTop - 55 // padding\n  var $links = $module.querySelectorAll('.idsk-in-page-navigation__list-item')\n\n  if (window.pageYOffset <= $navTopPosition) {\n    $module.classList.remove('idsk-in-page-navigation--sticky')\n  } else {\n    $module.classList.add('idsk-in-page-navigation--sticky')\n  }\n\n  if (this.$module.labelChanged) {\n    this.$module.labelChanged = false\n  } else if ($module.classList.contains('idsk-in-page-navigation--sticky')) {\n    var $self = this\n    $arrTitlesAndElems.some(function ($item, $index) {\n      if (\n        $item.el.offsetTop >= window.scrollY &&\n        $item.el.offsetTop <= window.scrollY + window.innerHeight\n      ) {\n        $self.changeCurrentLink($links[$index])\n\n        return true\n      }\n      return false\n    })\n  } else {\n    this.changeCurrentLink($links[0])\n  }\n}\n\n/**\n * InPageNavigation changeCurrentLink handler\n */\nIdskInPageNavigation.prototype.changeCurrentLink = function (el) {\n  var $module = this.$module\n  var $currItem = el.closest('.idsk-in-page-navigation__list-item')\n  var $articleTitle = $currItem.querySelector(\n    '.idsk-in-page-navigation__link-title'\n  )\n  var $items = $module.querySelectorAll('.idsk-in-page-navigation__list-item')\n  var $linkPanelText = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel-button'\n  )\n\n  $items.forEach(function ($item) {\n    $item.classList.remove('idsk-in-page-navigation__list-item--active')\n  })\n  $currItem.classList.add('idsk-in-page-navigation__list-item--active')\n  $linkPanelText.innerText = $articleTitle.innerText\n\n  // let active item be always visible\n  $currItem.scrollIntoView({\n    block: 'nearest',\n    inline: 'nearest'\n  })\n}\n\nexport default IdskInPageNavigation\n"],"names":[],"mappings":"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"}