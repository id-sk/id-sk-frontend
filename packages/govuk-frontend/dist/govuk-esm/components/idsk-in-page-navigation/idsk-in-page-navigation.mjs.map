{"version":3,"file":"idsk-in-page-navigation.mjs","sources":["../../../../src/govuk/components/idsk-in-page-navigation/idsk-in-page-navigation.mjs"],"sourcesContent":["/* eslint-disable */\n\n/**\n * InPageNavigation Component\n */\nfunction IdskInPageNavigation ($module) {\n  this.$module = $module\n}\n\n/**\n * InPageNavigation init function\n */\nIdskInPageNavigation.prototype.init = function () {\n  // Check for module\n  var $module = this.$module\n  if (!$module) {\n    return\n  }\n\n  // Check for button\n  var $links = $module.querySelectorAll('.idsk-in-page-navigation__link')\n  if (!$links) {\n    return\n  }\n\n  // list of all ids and titles\n  this.$arrTitlesAndElems = []\n  // Handle $link click events\n  $links.forEach(\n    function ($link) {\n      var $item = {}\n      $item.el = document.getElementById($link.href.split('#')[1])\n      this.$arrTitlesAndElems.push($item)\n      $link.addEventListener('click', this.handleClickLink.bind(this))\n    }.bind(this)\n  )\n\n  var $linkPanelButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel'\n  )\n  if (!$linkPanelButton) {\n    return\n  }\n  $module.boundCheckCloseClick = this.checkCloseClick.bind(this)\n  $module.boundHandleClickLinkPanel = this.handleClickLinkPanel.bind(this)\n  $linkPanelButton.addEventListener(\n    'click',\n    $module.boundHandleClickLinkPanel,\n    true\n  )\n\n  // Handle floating navigation\n  window.addEventListener('scroll', this.scrollFunction.bind(this))\n  // Handle case if the viewport is shor and there are more than one article - scrolling is not needed, but navigation pointer has to be updated\n  this.$module.labelChanged = false\n}\n\n/**\n * An event handler for click event on $link - add actual title to link panel\n *\n * @param {object} e\n */\nIdskInPageNavigation.prototype.handleClickLink = function (e) {\n  var $link = e.target || e.srcElement\n  var $id = $link.closest('.idsk-in-page-navigation__link').href.split('#')[1]\n  var $panelHeight = this.$module.getElementsByClassName(\n    'idsk-in-page-navigation__link-panel'\n  )[0].offsetHeight\n\n  setTimeout(\n    function () {\n      if (document.getElementById($id) != null) {\n        this.$module.labelChanged = true\n        this.changeCurrentLink($link)\n        window.scrollTo(\n          0,\n          document.getElementById($id).offsetTop - $panelHeight * 2.5\n        )\n      } else {\n        this.changeCurrentLink($link)\n      }\n    }.bind(this),\n    10\n  )\n}\n\n/**\n * An event handler for click event on $linkPanel - collapse or expand in page navigation menu\n *\n * @param {object} e\n */\nIdskInPageNavigation.prototype.handleClickLinkPanel = function (e) {\n  var $module = this.$module\n  var $linkPanelButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel'\n  )\n  var $expandedButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel-button'\n  )\n\n  $module.classList.add('idsk-in-page-navigation--expand')\n  $linkPanelButton.removeEventListener(\n    'click',\n    $module.boundHandleClickLinkPanel,\n    true\n  )\n  $expandedButton.setAttribute('aria-expanded', 'true')\n  $expandedButton.setAttribute(\n    'aria-label',\n    $expandedButton.getAttribute('data-text-for-show')\n  )\n  document.addEventListener('click', $module.boundCheckCloseClick, true)\n}\n\n/**\n * close navigation if the user click outside navigation\n *\n * @param {object} e\n */\nIdskInPageNavigation.prototype.checkCloseClick = function (e) {\n  var $el = e.target || e.srcElement\n  var $navigationList = $el.closest('.idsk-in-page-navigation__list')\n  var $module = this.$module\n  var $linkPanelButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel'\n  )\n  var $expandedButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel-button'\n  )\n\n  if ($navigationList == null) {\n    e.stopPropagation() // prevent bubbling\n    $module.classList.remove('idsk-in-page-navigation--expand')\n    $linkPanelButton.addEventListener(\n      'click',\n      $module.boundHandleClickLinkPanel,\n      true\n    )\n    document.removeEventListener('click', $module.boundCheckCloseClick, true)\n    $expandedButton.setAttribute('aria-expanded', 'false')\n    $expandedButton.setAttribute(\n      'aria-label',\n      $expandedButton.getAttribute('data-text-for-hide')\n    )\n  }\n}\n\n/**\n * When the user scrolls down from the top of the document, set position to fixed\n */\nIdskInPageNavigation.prototype.scrollFunction = function () {\n  var $module = this.$module\n  var $arrTitlesAndElems = this.$arrTitlesAndElems\n  var $parentModule = $module.parentElement\n  var $navTopPosition = $parentModule.offsetTop - 55 // padding\n  var $links = $module.querySelectorAll('.idsk-in-page-navigation__list-item')\n\n  if (window.pageYOffset <= $navTopPosition) {\n    $module.classList.remove('idsk-in-page-navigation--sticky')\n  } else {\n    $module.classList.add('idsk-in-page-navigation--sticky')\n  }\n\n  if (this.$module.labelChanged) {\n    this.$module.labelChanged = false\n  } else if ($module.classList.contains('idsk-in-page-navigation--sticky')) {\n    var $self = this\n    $arrTitlesAndElems.some(function ($item, $index) {\n      if (\n        $item.el.offsetTop >= window.scrollY &&\n        $item.el.offsetTop <= window.scrollY + window.innerHeight\n      ) {\n        $self.changeCurrentLink($links[$index])\n\n        return true\n      }\n      return false\n    })\n  } else {\n    this.changeCurrentLink($links[0])\n  }\n}\n\n/**\n * InPageNavigation changeCurrentLink handler\n */\nIdskInPageNavigation.prototype.changeCurrentLink = function (el) {\n  var $module = this.$module\n  var $currItem = el.closest('.idsk-in-page-navigation__list-item')\n  var $articleTitle = $currItem.querySelector(\n    '.idsk-in-page-navigation__link-title'\n  )\n  var $items = $module.querySelectorAll('.idsk-in-page-navigation__list-item')\n  var $linkPanelText = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel-button'\n  )\n\n  $items.forEach(function ($item) {\n    $item.classList.remove('idsk-in-page-navigation__list-item--active')\n  })\n  $currItem.classList.add('idsk-in-page-navigation__list-item--active')\n  $linkPanelText.innerText = $articleTitle.innerText\n\n  // let active item be always visible\n  $currItem.scrollIntoView({\n    block: 'nearest',\n    inline: 'nearest'\n  })\n}\n\nexport default IdskInPageNavigation\n"],"names":[],"mappings":"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"}