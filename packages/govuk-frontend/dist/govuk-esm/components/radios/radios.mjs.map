{"version":3,"file":"radios.mjs","sources":["../../../../src/govuk/components/radios/radios.mjs"],"sourcesContent":["import '../../vendor/polyfills/Element/prototype/classList.mjs'\n\n/**\n * Radios component\n *\n * @class\n * @param {Element} $module - HTML element to use for radios\n */\nfunction Radios ($module) {\n  if (!($module instanceof HTMLElement)) {\n    return this\n  }\n\n  /** @satisfies {NodeListOf<HTMLInputElement>} */\n  var $inputs = $module.querySelectorAll('input[type=\"radio\"]')\n  if (!$inputs.length) {\n    return this\n  }\n\n  /** @deprecated Will be made private in v5.0 */\n  this.$module = $module\n\n  /** @deprecated Will be made private in v5.0 */\n  this.$inputs = $inputs\n}\n\n/**\n * Initialise component\n *\n * Radios can be associated with a 'conditionally revealed' content block – for\n * example, a radio for 'Phone' could reveal an additional form field for the\n * user to enter their phone number.\n *\n * These associations are made using a `data-aria-controls` attribute, which is\n * promoted to an aria-controls attribute during initialisation.\n *\n * We also need to restore the state of any conditional reveals on the page (for\n * example if the user has navigated back), and set up event handlers to keep\n * the reveal in sync with the radio state.\n */\nRadios.prototype.init = function () {\n  // Check that required elements are present\n  if (!this.$module || !this.$inputs) {\n    return\n  }\n\n  var $module = this.$module\n  var $inputs = this.$inputs\n\n  $inputs.forEach(function ($input) {\n    var targetId = $input.getAttribute('data-aria-controls')\n\n    // Skip radios without data-aria-controls attributes, or where the\n    // target element does not exist.\n    if (!targetId || !document.getElementById(targetId)) {\n      return\n    }\n\n    // Promote the data-aria-controls attribute to a aria-controls attribute\n    // so that the relationship is exposed in the AOM\n    $input.setAttribute('aria-controls', targetId)\n    $input.removeAttribute('data-aria-controls')\n  })\n\n  // When the page is restored after navigating 'back' in some browsers the\n  // state of form controls is not restored until *after* the DOMContentLoaded\n  // event is fired, so we need to sync after the pageshow event in browsers\n  // that support it.\n  window.addEventListener(\n    'onpageshow' in window ? 'pageshow' : 'DOMContentLoaded',\n    this.syncAllConditionalReveals.bind(this)\n  )\n\n  // Although we've set up handlers to sync state on the pageshow or\n  // DOMContentLoaded event, init could be called after those events have fired,\n  // for example if they are added to the page dynamically, so sync now too.\n  this.syncAllConditionalReveals()\n\n  // Handle events\n  $module.addEventListener('click', this.handleClick.bind(this))\n}\n\n/**\n * Sync the conditional reveal states for all radio buttons in this $module.\n *\n * @deprecated Will be made private in v5.0\n */\nRadios.prototype.syncAllConditionalReveals = function () {\n  this.$inputs.forEach(this.syncConditionalRevealWithInputState.bind(this))\n}\n\n/**\n * Sync conditional reveal with the input state\n *\n * Synchronise the visibility of the conditional reveal, and its accessible\n * state, with the input's checked state.\n *\n * @deprecated Will be made private in v5.0\n * @param {HTMLInputElement} $input - Radio input\n */\nRadios.prototype.syncConditionalRevealWithInputState = function ($input) {\n  var targetId = $input.getAttribute('aria-controls')\n  if (!targetId) {\n    return\n  }\n\n  var $target = document.getElementById(targetId)\n  if ($target && $target.classList.contains('govuk-radios__conditional')) {\n    var inputIsChecked = $input.checked\n\n    $input.setAttribute('aria-expanded', inputIsChecked.toString())\n    $target.classList.toggle('govuk-radios__conditional--hidden', !inputIsChecked)\n  }\n}\n\n/**\n * Click event handler\n *\n * Handle a click within the $module – if the click occurred on a radio, sync\n * the state of the conditional reveal for all radio buttons in the same form\n * with the same name (because checking one radio could have un-checked a radio\n * in another $module)\n *\n * @deprecated Will be made private in v5.0\n * @param {MouseEvent} event - Click event\n */\nRadios.prototype.handleClick = function (event) {\n  var $component = this\n  var $clickedInput = event.target\n\n  // Ignore clicks on things that aren't radio buttons\n  if (!($clickedInput instanceof HTMLInputElement) || $clickedInput.type !== 'radio') {\n    return\n  }\n\n  // We only need to consider radios with conditional reveals, which will have\n  // aria-controls attributes.\n  /** @satisfies {NodeListOf<HTMLInputElement>} */\n  var $allInputs = document.querySelectorAll('input[type=\"radio\"][aria-controls]')\n\n  var $clickedInputForm = $clickedInput.form\n  var $clickedInputName = $clickedInput.name\n\n  $allInputs.forEach(function ($input) {\n    var hasSameFormOwner = $input.form === $clickedInputForm\n    var hasSameName = $input.name === $clickedInputName\n\n    if (hasSameName && hasSameFormOwner) {\n      $component.syncConditionalRevealWithInputState($input)\n    }\n  })\n}\n\nexport default Radios\n"],"names":[],"mappings":"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"}